<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>laravel-12 測試 | Vince的學習筆記</title>
    <meta name="author" content="Vince Lo" />
    <meta name="keywords" content="" />
    <meta name="description" content=" 測試基礎12-1　tests/ExampleTest.php1234567891011121314151617&amp;lt;?phpuse Illuminate\Foundation\Testing\WithoutMiddleware;use Illuminate\Foundation\Testing\DatabaseMigrations;use Illuminate\Foundation\Testing\DatabaseTransactions;class ExampleTest ext..." />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="Vince的學習筆記" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]>
    <style type="text/css">
    .nav-inner {top:0;}
    .author-meta {position:static;top:0;}
    .search-form {height:36px;}
    </style>
    <script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <![endif]-->
<meta name="generator" content="Hexo 4.2.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Vince的學習筆記</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首頁</span>
            </a>
        
            <a class="nav-item" href="/categories/design">
                <span class="nav-text">設計</span>
            </a>
        
            <a class="nav-item" href="/categories/frontend">
                <span class="nav-text">前端</span>
            </a>
        
            <a class="nav-item" href="/categories/backend">
                <span class="nav-text">後端</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">標籤</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">歸檔</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">關於</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://vince115.github.io"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#測試基礎"><span class="toc-number">1.</span> <span class="toc-text"> 測試基礎</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#json-測試範例"><span class="toc-number">1.1.</span> <span class="toc-text"> JSON 測試範例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#測試環境"><span class="toc-number">2.</span> <span class="toc-text"> 測試環境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#測試特徵"><span class="toc-number">3.</span> <span class="toc-text"> 測試特徵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#應用測試"><span class="toc-number">4.</span> <span class="toc-text"> 應用測試</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#testcase"><span class="toc-number">5.</span> <span class="toc-text"> TestCase</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#造訪路由"><span class="toc-number">6.</span> <span class="toc-text"> &quot;造訪&quot;路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#json與非visit應用測試判斷式"><span class="toc-number">7.</span> <span class="toc-text"> JSON與非visit()應用測試判斷式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#點擊與表單"><span class="toc-number">8.</span> <span class="toc-text"> 點擊與表單</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#工作與事件"><span class="toc-number">9.</span> <span class="toc-text"> 工作與事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#身分驗證與session"><span class="toc-number">10.</span> <span class="toc-text"> 身分驗證與session</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#artisan與種子"><span class="toc-number">11.</span> <span class="toc-text"> Artisan與種子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模仿程式"><span class="toc-number">12.</span> <span class="toc-text"> 模仿程式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mockery"><span class="toc-number">13.</span> <span class="toc-text"> Mockery</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            laravel-12 測試
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://vince115.github.io/2020/06/29/laravel-12/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2020-06-29T06:14:25.000Z" itemprop="datePublished">2020-06-29</time>
</a>

            

        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h3 id="測試基礎"><a class="markdownIt-Anchor" href="#測試基礎"></a> 測試基礎</h3>
<p>12-1　tests/ExampleTest.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Testing</span>\<span class="title">WithoutMiddleware</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Testing</span>\<span class="title">DatabaseMigrations</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Testing</span>\<span class="title">DatabaseTransactions</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="keyword">extends</span> <span class="title">TestCase</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * A basic functional test example.</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testBasicExample</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;visit(<span class="string">'/'</span>)</span><br><span class="line">        -&gt;see(<span class="string">'Laravel'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-2 ExampleTest輸出範例</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PHPUnit <span class="number">5.5</span><span class="number">.2</span> by Sebastian Bergmann <span class="keyword">and</span> contributors.</span><br><span class="line">.</span><br><span class="line">Time: <span class="number">139</span> ms, Memory: <span class="number">12.00</span>Mb</span><br><span class="line">OK (<span class="number">1</span> test, <span class="number">2</span> assertions)</span><br></pre></td></tr></table></figure>
<p>12-3 test/ExampleTest.php 編輯為失敗</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testBasicExample</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;visit(<span class="string">'/'</span>)</span><br><span class="line">    -&gt;see(<span class="string">'Applesauce'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-4 ExampleTest 失敗輸出範例</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PHPUnit <span class="number">5.5</span><span class="number">.2</span> by Sebastian Bergmann <span class="keyword">and</span> contributors.</span><br><span class="line">F</span><br><span class="line">Time: <span class="number">115</span> ms, Memory: <span class="number">12.00</span>Mb</span><br><span class="line">There was <span class="number">1</span> failure:</span><br><span class="line"><span class="number">1</span>) ExampleTest::testBasicExample</span><br><span class="line">&lt;source of page here&gt;</span><br><span class="line">Failed asserting that the page contains the HTML [Applesauce].</span><br><span class="line">Please check the content above.</span><br><span class="line">/path-to-your-app/vendor/.../Foundation/Testing/Constraints/PageConstraint.php:<span class="number">90</span></span><br><span class="line">/path-to-your-app/vendor/.../Foundation/Testing/Concerns/InteractsWithPages.php:<span class="number">271</span></span><br><span class="line">/path-to-your-app/vendor/.../Foundation/Testing/Concerns/InteractsWithPages.php:<span class="number">287</span></span><br><span class="line">/path-to-your-app/tests/ExampleTest.php:<span class="number">21</span></span><br><span class="line">FAILURES!</span><br><span class="line">Tests: <span class="number">1</span>, Assertions: <span class="number">2</span>, Failures: <span class="number">1.</span></span><br></pre></td></tr></table></figure>
<h4 id="json-測試範例"><a class="markdownIt-Anchor" href="#json-測試範例"></a> JSON 測試範例</h4>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_people_list_shows_person_after_creation</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;json(<span class="string">'post'</span>, <span class="string">'people'</span>, [<span class="string">'name'</span> =&gt; <span class="string">'matt'</span>]);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;json(<span class="string">'get'</span>, <span class="string">'people'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;seeJson([<span class="string">'name'</span> =&gt; <span class="string">'matt'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-5 命名PHPUnit方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Naming</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_it_names_things_well</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="comment">// Runs as "test it names things well"  </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testItNamesThingsWell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="comment">// Runs as "It names things well"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** <span class="doctag">@test</span> */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">it_names_things_well</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="comment">// Runs as "it names things well"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">it_names_things_well</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="comment">// Doesn't run</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="測試環境"><a class="markdownIt-Anchor" href="#測試環境"></a> 測試環境</h3>
<h3 id="測試特徵"><a class="markdownIt-Anchor" href="#測試特徵"></a> 測試特徵</h3>
<p>WithoutMiddleware<br />
DatabaseMigrations<br />
DatabaseTransactions</p>
<h3 id="應用測試"><a class="markdownIt-Anchor" href="#應用測試"></a> 應用測試</h3>
<h3 id="testcase"><a class="markdownIt-Anchor" href="#testcase"></a> TestCase</h3>
<h3 id="造訪路由"><a class="markdownIt-Anchor" href="#造訪路由"></a> &quot;造訪&quot;路由</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;vist($uri)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;call($method, $uri, $params = [], $cookies = [], $files = [], $server = [],</span><br><span class="line">$content = <span class="keyword">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;get($uri, $headers = []), -&gt;post($uri, $data = [], $headers = []),</span><br><span class="line">-&gt;put($uri, $data = [], $headers = []), -&gt;patch(), <span class="keyword">and</span> -&gt;delete()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;json($method, $uri, $data = [], $headers = [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;followRedirects()</span><br></pre></td></tr></table></figure>
<p>###自訂應用測試判斷式</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;assertPageLoaded()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;see() <span class="keyword">and</span> -&gt;dontSee()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seeHeader()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seeCookie()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seeInField() <span class="keyword">and</span> -&gt;dontSeeInField()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seeIsChecked() <span class="keyword">and</span> -&gt;dontSeeIsChecked()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seeIsSelected() <span class="keyword">and</span> -&gt;dontSeeIsSelected()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seePageIs()</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;seeInDatabase() <span class="keyword">and</span> -&gt;dontSeeInDatabase()</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_database_has_user_after_registration</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span></span><br><span class="line">        -&gt;visit(<span class="string">'register'</span>)</span><br><span class="line">        -&gt;fillForm([</span><br><span class="line">            <span class="string">'email'</span> =&gt; <span class="string">'matt@mattstauffer.co'</span></span><br><span class="line">        ])</span><br><span class="line">        -&gt;submitForm();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;seeInDatabase(<span class="string">'emails'</span>, [<span class="string">'email'</span> =&gt; <span class="string">'matt@mattstauffer.co'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="json與非visit應用測試判斷式"><a class="markdownIt-Anchor" href="#json與非visit應用測試判斷式"></a> JSON與非visit()應用測試判斷式</h3>
<p>$this-&gt;seeJson(), -&gt;dontSeeJson(), -&gt;seeJsonEquals()</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_api_returns_certain_json</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;json(<span class="string">'get'</span>, <span class="string">'users'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;seeJson([<span class="string">'username'</span> =&gt; <span class="string">'mattstauffer'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>R</mi><mi>e</mi><mi>s</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>O</mi><mi>K</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mi>a</mi><mi>n</mi><mi>d</mi><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>R</mi><mi>e</mi><mi>s</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>e</mi><mi>S</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>s</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">this-&gt;assertResponseOK() and -&gt;assertResponseStatus(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mclose">)</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mopen">(</span></span></span></span>status)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_pages_load_the_way_we_want</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'people'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertResponseOK();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;call(<span class="string">'post'</span>, <span class="string">'owners'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertResponseStatus(<span class="number">405</span>); <span class="comment">// Method not allowed</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>V</mi><mi>i</mi><mi>e</mi><mi>w</mi><mi>H</mi><mi>a</mi><mi>s</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">this-&gt;assertViewHas(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">i</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mopen">(</span></span></span></span>key, $value = null), -&gt;assertViewHasAll(array <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>V</mi><mi>i</mi><mi>e</mi><mi>w</mi><mi>M</mi><mi>i</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">bindings), -&gt;assertViewMissing(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">i</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span></span></span></span>key)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Route</span></span><br><span class="line">Route::get(<span class="string">'test'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'test'</span>)-&gt;with(<span class="string">'foo'</span>, <span class="string">'bar'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_view_gets_data</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'test'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertViewHas(<span class="string">'foo'</span>); <span class="comment">// true</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertViewHas(<span class="string">'foo'</span>, <span class="string">'bar'</span>); <span class="comment">// true</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertViewHas(<span class="string">'foo'</span>, <span class="string">'baz'</span>); <span class="comment">// false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Route</span></span><br><span class="line">Route::get(<span class="string">'test'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'test'</span>)</span><br><span class="line">    -&gt;with(<span class="string">'foo'</span>, <span class="string">'bar'</span>)</span><br><span class="line">    -&gt;with(<span class="string">'baz'</span>, <span class="string">'qux'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_view_gets_data</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'test'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertViewHasAll([</span><br><span class="line">        <span class="string">'foo'</span> =&gt; <span class="string">'bar'</span>,</span><br><span class="line">        <span class="string">'baz'</span> =&gt; <span class="string">'qux'</span></span><br><span class="line">    ]); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//In Laravel 5.3</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_events_are_owned_by_user_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'events'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertViewHas(<span class="string">'events'</span>, <span class="function"><span class="keyword">function</span> <span class="params">($events)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $events-&gt;reject(<span class="function"><span class="keyword">function</span> <span class="params">($event)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $event-&gt;user_id === <span class="number">1</span>;</span><br><span class="line">        &#125;)-&gt;isEmpty();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$this-&gt;assertRedirectedTo(), -&gt;assertRedirectedToRoute(), -&gt;assertRedirectedToAction()</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Route</span></span><br><span class="line">Route::get(<span class="string">'redirector'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">'/'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">Route::get(<span class="string">'/'</span>, <span class="string">'HomeController@index'</span>)-&gt;name(<span class="string">'home'</span>);</span><br><span class="line"><span class="comment">// Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_redirector_works</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'redirector'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertRedirectedTo(<span class="string">'/'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertRedirectedToRoute(<span class="string">'home'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertRedirectedToAction(<span class="string">'HomeController@index'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>S</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>H</mi><mi>a</mi><mi>s</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">this-&gt;assertSessionHas(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mopen">(</span></span></span></span>key, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><msup><mo>=</mo><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>S</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>H</mi><mi>a</mi><mi>s</mi><mi>A</mi><mi>l</mi><mi>l</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">value = &#x27;&#x27;),
-&gt;assertSessionHasAll(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">=</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span></span></span></span>bindings), -&gt;assertSessionHasErrors(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">bindings = [],
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span>format = null), -&gt;assertHasOldInput()</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_session_has_stuff</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Session::put(<span class="string">'foo'</span>, <span class="string">'bar'</span>);</span><br><span class="line">    Session::put(<span class="string">'baz'</span>, <span class="string">'qux'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertSessionHas(<span class="string">'foo'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertSessionHas(<span class="string">'foo'</span>, <span class="string">'bar'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertSessionHasAll([</span><br><span class="line">        <span class="string">'foo'</span> =&gt; <span class="string">'bar'</span>,</span><br><span class="line">        <span class="string">'baz'</span> =&gt; <span class="string">'qux'</span></span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_posting_empty_errors_out</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// assuming the "/form" route requires an email field, and we're</span></span><br><span class="line">    <span class="comment">// posting an empty form to it to trigger the error</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;post(<span class="string">'form'</span>, []);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertSessionHasErrors();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertSessionHasErrors([<span class="string">'email'</span> =&gt; <span class="string">'The email field is required.'</span>]);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertSessionHasErrors(</span><br><span class="line">        [<span class="string">'email'</span> =&gt; <span class="string">'&lt;p&gt;The email field is required.&lt;/p&gt;'</span>],</span><br><span class="line">        <span class="string">'&lt;p&gt;:message&lt;/p&gt;'</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="點擊與表單"><a class="markdownIt-Anchor" href="#點擊與表單"></a> 點擊與表單</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;click($name);</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;type($text, $element)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;check($element)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;uncheck($element)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;select($option, $element)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;attach($filePath, $element)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;press($buttonText)</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;submitForm($buttonText, $inputs = [], $uploads = [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;fillForm($buttonText, $inputs = [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;clearInputs()</span><br></pre></td></tr></table></figure>
<h3 id="工作與事件"><a class="markdownIt-Anchor" href="#工作與事件"></a> 工作與事件</h3>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>s</mi><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">this-&gt;expectsEvents(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mopen">(</span></span></span></span>eventClassName)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_usersubscribed_event_fires_when_subscribing</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;expectsEvents(App\Events\UserSubscribed::class);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;visit(<span class="string">'subscribe'</span>)-&gt;type(<span class="string">'me@me.com'</span>, <span class="string">'email'</span>)-&gt;press(<span class="string">'Subscribe'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>w</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">this-&gt;withoutEvents()
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span>this-&gt;expectsJobs()</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_number_of_subscriptions_crunches_reports</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;expectsJobs(App\Jobs\CrunchReports::class);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;visit(<span class="string">'subscribe'</span>)-&gt;type(<span class="string">'me@me.com'</span>, <span class="string">'email'</span>)-&gt;press(<span class="string">'Subscribe'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="身分驗證與session"><a class="markdownIt-Anchor" href="#身分驗證與session"></a> 身分驗證與session</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;session([<span class="string">'key'</span> =&gt; <span class="string">'value'</span>])</span><br><span class="line"><span class="keyword">$this</span>-&gt;flushSession()</span><br><span class="line"><span class="keyword">$this</span>-&gt;be($authenticatable)</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_members_cant_see_admin_dashboard</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $member = factory(\App\User::class, <span class="string">'member'</span>)-&gt;create();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;be($member);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'admin-dashboard'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertResponseStatus(<span class="number">403</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_admins_can_see_admin_dashboard</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $admin = factory(\App\User::class, <span class="string">'admin'</span>)-&gt;create();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;be($admin);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;get(<span class="string">'admin-dashboard'</span>);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertResponseOK();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="artisan與種子"><a class="markdownIt-Anchor" href="#artisan與種子"></a> Artisan與種子</h3>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>a</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>s</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">this-&gt;artisan(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mopen">(</span></span></span></span>command, $parameters = [])</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_returns_certain_code</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;artisan(<span class="string">'do:thing'</span>, [<span class="string">'--flagOfSomeSort'</span> =&gt; <span class="keyword">true</span>]);</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertEquals(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;code); <span class="comment">// 0 means "no errors were returned"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>h</mi><mi>i</mi><mi>s</mi><mo>−</mo><mo>&gt;</mo><mi>s</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">this-&gt;seed(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mopen">(</span></span></span></span>seederClassName = ‘DatabaseSeeder’)<br />
seed()提供功能與執行$this-&gt;artisan(‘db:seed’)相同</p>
<h3 id="模仿程式"><a class="markdownIt-Anchor" href="#模仿程式"></a> 模仿程式</h3>
<h3 id="mockery"><a class="markdownIt-Anchor" href="#mockery"></a> Mockery</h3>
<p>12-6 在Laravel中使用Mockery</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/SlackClient.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SlackClient</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">($message, $channel)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Actually sends a message to Slack</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// app/Notifier.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Notifier</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $slack;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(SlackClient $slack)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;slack = $slack;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notifyAdmins</span><span class="params">($message)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;slack-&gt;send($message, <span class="string">'admins'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// tests/NotifierTest.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_notifier_notifies_admins</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $slackMock = Mockery::mock(SlackClient::class)-&gt;shouldIgnoreMissing();</span><br><span class="line">    $notifier = <span class="keyword">new</span> Notifier($slackMock);</span><br><span class="line">    $notifier-&gt;notifyAdmins(<span class="string">'Test message'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-7 在Mockery模仿物中使用shouldReceive方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_notifier_notifies_admins</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $slackMock = Mockery::mock(SlackClient::class);</span><br><span class="line">    $slackMock-&gt;shouldReceive(<span class="string">'send'</span>)-&gt;once();</span><br><span class="line">    $notifier = <span class="keyword">new</span> Notifier($slackMock);</span><br><span class="line">    $notifier-&gt;notifyAdmins(<span class="string">'Test message'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-8 綁定一個Mockery實例到容器</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_notifier_notifies_admins</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $slackMock = Mockery::mock(SlackClient::class);</span><br><span class="line">    $slackMock-&gt;shouldReceive(<span class="string">'send'</span>)-&gt;once();</span><br><span class="line">    app()-&gt;instance(SlackClient::class, $slackMock);</span><br><span class="line">    $notifier = app(Notifier::class);</span><br><span class="line">    $notifier-&gt;notifyAdmins(<span class="string">'Test message'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-9 綁定一個Mockery實例到容器</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PeopleController</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Cache::remember(<span class="string">'people'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Person::all();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// PeopleTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_all_people_route_should_be_cached</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $person = factory(Person::class)-&gt;make();</span><br><span class="line">    Cache::shouldReceive(<span class="string">'remember'</span>)</span><br><span class="line">        -&gt;once()</span><br><span class="line">        -&gt;andReturn(collect([$person]));</span><br><span class="line">    <span class="keyword">$this</span>-&gt;visit(<span class="string">'people'</span>)-&gt;seeJson([<span class="string">'name'</span> =&gt; $person-&gt;name]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12-10 靜態介面間諜</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_queue_job_should_be_pushed_after_regisration</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Cache::spy();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;post(<span class="string">'register'</span>, [<span class="string">'email'</span> =&gt; <span class="string">'joaquin@me.com'</span>]);</span><br><span class="line">    Cache::shouldHaveReceived(<span class="string">'push'</span>)</span><br><span class="line">        -&gt;with(SendWelcomeEmail::class, [<span class="string">'email'</span> =&gt; <span class="string">'joaquin@me.com'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
    </section>
</article>



<a id="pagenext" href="/2020/06/29/laravel-11/" class="article-next" title="laravel-11 容器"><i class="icon-arrow-right"></i></a>


<a id="pageprev" href="/2020/06/29/laravel-13/" class="article-prev" title="laravel-13 編寫API"><i class="icon-arrow-left"></i></a>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "7fbe80427f54741e289f",
        clientSecret: "f34ed5fd92e54c9000bd37ba951948cb939deff5",
        repo: "sanonz.github.io",
        owner: "sanonz",
        admin: ["sanonz"],
        id: "2020/06/29/laravel-12",
        distractionFreeMode: true,
        title: "laravel-12 測試",
        body: "http://vince115.github.io/2020/06/29/laravel-12/",
        labels: []
    }).render('comments');
    </script>
</div>


            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    
        
<script src="/js/scrollspy.min.js"></script>

        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});

        $(window).on('resize', function() {
            var hw = $('#header').width();
            var ww = $('#wrapper').width();
            var space = ($(this).width() - hw - ww) / 2 / 2;

            var pageprev = $('#pageprev');
            var pagenext = $('#pagenext');
            var avg = (pageprev.width() + pagenext.width()) / 2

            if(space > avg) {
                var len = space - avg / 2;
                var styles = {position: 'fixed', top: '50%', marginTop: - (pageprev.width() + pagenext.width()) / 4}
                pageprev.css($.extend({left: hw + len}, styles));
                pagenext.css($.extend({right: len}, styles));
            } else {
                pageprev.removeAttr('style');
                pagenext.removeAttr('style');
            }
        }).trigger('resize');
        </script>
    

</body>
</html>
